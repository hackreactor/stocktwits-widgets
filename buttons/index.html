<!doctype html>
<html>
<body>
  <!-- Emulate what can be done server side anyway -->
  <script>
    var params = (function () {
      var hash;
      var vars  = {};
      var query = window.location.search.slice(1).split('&');
      for (var i = 0; i < query.length; i++) {
        hash = query[i].split('=');
        vars[hash[0]] = hash[1];
      }
      return vars;
    })();
  </script>
  <!-- Inline styles to minimise HTTP requests -->
  <style>
    html,
    body {
      width: 100%;
      height: 100%;
    }
    body {
      margin: 0;
      overflow: hidden;
      /* StockTwits styles */
      font-family: Arial, sans-serif;
    }
    .st-btn,
    .st-icon,
    .st-text {
      float: left;
    }
    .st-btn {
      height: 18px;
      max-width: 98%;

      background-color: #f8f8f8;
      background-image: -webkit-gradient(linear,left top,left bottom,from(#fff),to(#dedede));
      background-image: -moz-linear-gradient(top,#fff,#dedede);
      background-image: -o-linear-gradient(top,#fff,#dedede);
      background-image: -ms-linear-gradient(top,#fff,#dedede);
      background-image: linear-gradient(top,#fff,#dedede);
      border: #ccc solid 1px;
      -webkit-border-radius: 3px;
      border-radius: 3px;
      color: #333;
      font-weight: bold;
      text-shadow: 0 1px 0 rgba(255,255,255,.5);
      -webkit-user-select: none;
      -moz-user-select: none;
      -o-user-select: none;
      user-select: none;
      cursor: pointer;
      overflow: hidden;
    }
    .st-btn:focus,
    .st-btn:hover,
    .st-btn:active {
      border-color: #bbb;
      background-color: #f8f8f8;
      background-image: -webkit-gradient(linear,left top,left bottom,from(#f8f8f8),to(#d9d9d9));
      background-image: -moz-linear-gradient(top,#f8f8f8,#d9d9d9);
      background-image: -o-linear-gradient(top,#f8f8f8,#d9d9d9);
      background-image: -ms-linear-gradient(top,#f8f8f8,#d9d9d9);
      background-image: linear-gradient(top,#f8f8f8,#d9d9d9);
      -webkit-box-shadow: none;
      -moz-box-shadow: none;
      box-shadow: none;
    }
    .st-btn:focus {
      border-color: #0089CB;
    }
    .st-btn:active {
      background-color: #efefef;
      -webkit-box-shadow: inset 0 3px 5px rgba(0,0,0,0.1);
      -moz-box-shadow: inset 0 3px 5px rgba(0,0,0,0.1);
      box-shadow: inset 0 3px 5px rgba(0,0,0,0.1);
    }
    .st-icon {
      width: 16px;
      height: 16px;
      margin: 1px 0 1px 2px;
      background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEKGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS4xLjIiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iPgogICAgICAgICA8eG1wOk1vZGlmeURhdGU+MjAxMy0wNS0wM1QxMDowNTo5MjwveG1wOk1vZGlmeURhdGU+CiAgICAgICAgIDx4bXA6Q3JlYXRvclRvb2w+QWRvYmUgSW1hZ2VSZWFkeTwveG1wOkNyZWF0b3JUb29sPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICAgICA8dGlmZjpZUmVzb2x1dGlvbj43MjwvdGlmZjpZUmVzb2x1dGlvbj4KICAgICAgICAgPHRpZmY6Q29tcHJlc3Npb24+NTwvdGlmZjpDb21wcmVzc2lvbj4KICAgICAgICAgPHRpZmY6UmVzb2x1dGlvblVuaXQ+MTwvdGlmZjpSZXNvbHV0aW9uVW5pdD4KICAgICAgICAgPHRpZmY6WFJlc29sdXRpb24+NzI8L3RpZmY6WFJlc29sdXRpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyI+CiAgICAgICAgIDxleGlmOlBpeGVsWERpbWVuc2lvbj4xNjwvZXhpZjpQaXhlbFhEaW1lbnNpb24+CiAgICAgICAgIDxleGlmOkNvbG9yU3BhY2U+NjU1MzU8L2V4aWY6Q29sb3JTcGFjZT4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjE2PC9leGlmOlBpeGVsWURpbWVuc2lvbj4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+Ci/5//gAAAMhSURBVDgRhZNrSBRRFMfPzOxz3LZdzdpSc1XMEEkJCqQss9LINAtf+dgeKKYRfQj8EJVSYFHYp54WaemHNKlQCQo0Q0mrVSSSbLU0LR/FamrOuju7nu5cXQO/dOHMzD3nf3535pwzDCLC0pXJMHqWV6a67I54nEN/EndxMq6bkytruwXhuRlRdOcwSwGmZert4sxsBb9ca/QLCwNep4c5lwusg4Pwo6cHCKiZZWWHHwjCIIVIALdla1QxaQBCSdxu/NbVRdz/lmN2Fl9XVGCeYRVmKGSWTLXal0RhMfkIgO4QA5ar+xNQJGJpTVut2P2qCb92dKBLFKmvp7UVc1d4YrZaUUMc/wAmpbwgz7ASRyyfqdDS0oqnfYIwg2UxSy7D67kmdOA85NmlEkwndcni+Y2suxiiU9wTGr0DDMHrAMU5eHihED5EDIFK7QG8KIOytVVwb+YWlW9KOgAaLz3LMriTAlIZhpPJFQHe/lLBAcY/9UP7tn7oqtaAuZ6HkaNasO5QgO2imcY9fXwIwAs89LoQCkgpLua0BoPcPjNDBaxWCc5QD4jZheBX7oTOKwiGFwi6vvkXdpGuOAQB1m4IV84DioocoVFRQ1/M7ylAb/SFxNoIcLZPgHflFESvn4bAUjuEpcXT+FhvL1i/D0N4XFy/jHrIxTY1NfDF3AG9bW0QHBkJpsvXAOwu6Hv3FhRyFewqzIfNKclU3ni3DBRqJUTs3ddK20jcpoMAzsdF59HS9gaHFzohtePPxASST6OdkS6NZXcwiTTv0dkz7WTLQaZSFpvBMa77JwqoaGJ4GIujtuLLmzfw9+gokilEh82GA2Sw7uQco8nXUpIFURC2kASAk4HG26mE+LGpkQKuJCZgOsdgpkKOhz14JHHMX70KJU02r8KaovO/yKDFScmSMZ0NDReuJiacWxMSAgzHwU8y84VPn9Tp1viOd9bX7Rnr6/UkLZ7zCw8fidgdW+9lNJaSQgy6aydR9C1VlW3HySmnggKxu7m5mvjkCydoyT2YWAAx1YJvcfylvftv9LRNTuawHDel1GjKCd2+eMJ/Hv4CpBPQ/CleHMgAAAAASUVORK5CYII=");
      *background-image: url("favicon.png");
      background-repeat: no-repeat;
    }
    .st-text {
      padding: 0 2px;
      font-size: 12px;
      line-height: 18px;
    }
  </style>
  <!-- StockTwits Button used to render -->
  <span class="stocktwits-btn" id="stocktwits-btn">
    <a class="st-btn" id="st-btn" href="https://stocktwits.com/widgets/share" target="_blank">
      <span class="st-icon"></span>
      <span class="st-text" id="st-text">Share</span>
    </a>
    <a class="st-count" id="st-count" href="#" target="_blank"></a>
  </span>
  <!-- Inline script tags to minimise HTTP requests -->
  <script>
    var stBtn     = document.getElementById('st-btn'),
        stTxt     = document.getElementById('st-text'),
        innerText = (document.getElementsByTagName('body')[0].innerText != null) ? 'innerText' : 'textContent';

    var addEvent = function (el, event, fn) {
      if (el.addEventListener) {
        el.addEventListener(event, fn, false);
      } else if (el.attachEvent) {
        el.attachEvent('on' + event, fn);
      }
    };
    // https://stocktwits.com/widgets/share?body=StockTwits%20for%20Developers%20http%3A%2F%2Fstocktwits.com%2Fdevelopers%2Fdocs%2Fshare-button
    switch (params.type) {
      case 'follow':
        stBtn.href = '//stocktwits.com/' + encodeURI(params.user);
        stTxt[innerText] = 'Follow @' + params.user;
        break;
      case 'mention':
        stBtn.href += '?body=' + encodeURIComponent('$' + params.cashtag);
        stTxt[innerText] = 'Mention $' + params.cashtag.toUpperCase();
        break;
      case 'message':
        stBtn.href += '?body=' + encodeURIComponent('d ' + params.user);
        stTxt[innerText] = 'Message @' + params.user;
        break;
    }

    addEvent(stBtn, 'click', function (e) {
      var width  = 500,
          height = 300,
          left   = (window.screen.availWidth - width) / 2;
      e.preventDefault();
      window.open(this.href, '', 'left=' + left + ',top=100,width=' + width + ',height=' + height);
    }, false);
  </script>
</body>
</html>
